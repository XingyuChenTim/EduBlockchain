extends layout

block content
  .container
    h1 #{__('Private & Public Key')}
    p
      | In the real Bitcoin network, the public key is generated by applying secp256k1 with the ECDSA algorithm
      | to users private key. Hence, the public key length is 65 bytes.
    .well#block1chain1key
      form.form-horizontal
        .form-group
          label.control-label Private Key In Decimal format
          .input-group
            input.form-control#privateKey(aria-label='Private Key', type='text')
            span.input-group-btn
              button#randomButton.btn.btn-primary.ladda-button(type='button') Random GenKey
        .form-group
          label.control-label Private Key In Hex format
          input#privateKeyH.form-control(disabled)
        .form-group
          label.control-label Public Key
          input#publicKey.form-control(disabled)

    a(href='https://en.bitcoin.it/wiki/Secp256k1') For detailed information of public-key cryptography, please check this web link

  script.
    var EC = elliptic.elliptic().ec;
    var ec = new EC('secp256k1');

    var keypair = ec.genKeyPair();
    if (Cookies.get('privateKey')) {
      keypair = ec.keyFromPrivate(Cookies.get('privateKey'));
    }

    function update() {
      var prv = keypair.getPrivate('hex');
      var prvh = keypair.getPrivate('hex');
      var pub = keypair.getPublic('hex');
      $('#privateKey').val(bigInt(prv, 16).toString());
      $('#privateKeyH').val(prvh);
      $('#publicKey').val(pub);
      Cookies.set('privateKey', prv.toString());
      Cookies.set('privateKeyH', prvh.toString());
      Cookies.set('publicKey', pub.toString());
    }

    function random() {
      keypair = ec.genKeyPair();
      update();
    }

    $(function() {
      $('#randomButton').click(random);
      $('#privateKey').bind('keyup', function() {
        $('#privateKey').val($('#privateKey').val().replace(/\D+/g, ''));
        keypair = ec.keyFromPrivate(bigInt($('#privateKey').val()).toString(16));
        update();
      });
      update();
    });
